# 
#  Copyright (c) 2012, Texas Instruments Incorporated
#  All rights reserved.
# 
#  Redistribution and use in source and binary forms, with or without
#  modification, are permitted provided that the following conditions
#  are met:
# 
#  *  Redistributions of source code must retain the above copyright
#     notice, this list of conditions and the following disclaimer.
# 
#  *  Redistributions in binary form must reproduce the above copyright
#     notice, this list of conditions and the following disclaimer in the
#     documentation and/or other materials provided with the distribution.
# 
#  *  Neither the name of Texas Instruments Incorporated nor the names of
#     its contributors may be used to endorse or promote products derived
#     from this software without specific prior written permission.
# 
#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
#  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
#  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
#  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
#  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
#  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
#  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;
#  OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
#  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
#  OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
#  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
# 
%%{
    var dirName = this.filePath.substring(this.filePath.lastIndexOf('/') + 1);
    var target = this.dirMap[dirName].target;
    var profile = this.dirMap[dirName].profile;
    var name = target.name;
    var suffix = target.suffix;
    var platform = this.dirMap[dirName].platform;
    var cfgPkgName = "configPkg";
    var legacyPath = xdc.findFile("ti/bios/package.xdc").split("package.xdc");
    legacyPath = legacyPath[0].replace(/\\/g, '/');
    legacyPath += "include/";
    var percent = "%";
%%}
## THIS FILE WAS GENERATED BY ti.sysbios.genx

include ../../common/common.mak

CONFIGPKG = ./`cfgPkgName`

all: legacy.out

## generate and build the `platform` configuro package
`percent`/compiler.opt `percent`/linker.cmd: legacy.cfg makefile
	@$(REMOVE) $(CONFIGPKG)
	@$(XS) xdc.tools.configuro -t `target` -p `platform` -o $(CONFIGPKG) -r `profile` --cb legacy.cfg
	
## build the test executable
legacy.out : ../legacy.c $(CONFIGPKG)/compiler.opt $(CONFIGPKG)/linker.cmd
	@echo making $@
	@$(CL_`suffix`) $(CL_OPTS_`suffix`) -@ $(CONFIGPKG)/compiler.opt -I "`legacyPath`" ../legacy.c
	@$(LNK_`suffix`) $(LNK_OPTS_`suffix`) -o legacy.out legacy.obj -c -m legacy.map $(CONFIGPKG)/linker.cmd $(RTS_LIB_`suffix`)

## clean up
clean:
	@$(REMOVE) *.obj *.out *.map $(CONFIGPKG)
#
#  @(#) ti.sysbios.genx; 2, 0, 0, 0,527; 5-18-2012 06:05:28; /db/vtree/library/trees/avala/avala-q37x/src/ xlibrary

#

